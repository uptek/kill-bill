=== Overview

A customer account can have several payment methods to allow for making payments in different ways, such as credit cards, debit cards, PayPal, and so forth. The payment method includes the details needed for Kill Bill to process a payment against an invoice.

Saving this information in Kaui makes it easier to accept payments from the customer because the customer or service staff don't need to repeatedly provide their payment method details.

In production systems, payment method information is typically added via gateway-specific data flows. However, developers can use the Payment Method section for testing purposes.

[NOTE]
*Note:* Although you can't edit a payment method, you can delete it.

[WARNING]
*Warning!* For PCI compliance, _do not_ enter any genuine payment information in these fields.

=== About Payment Plugin Names

Each payment method is associated with a payment plugin, a type of software that performs the backend processing for that specific payment method. The *Plugin name* field specifies the name of this payment plugin. (_Example:_ `killbill-stripe`).

The plugin name is typically mentioned in the plugin's `readme` file. For example, in the https://github.com/killbill/killbill-stripe-plugin#using-stripe-checkout[Stripe plugin `readme` file], the plugin name is specified in the command line.

=== View Payment Method Details

To view a payment method after it's created:

. Open the account on the Account page.
. In the *Payment Methods* area, click the gray down arrow image:../assets/img/kaui/i_GrayDownArrow.png[] next to the payment method.
+
Kaui expands the details for the payment method:
+
image::../assets/img/kaui/PaymentMethod-Expanded.png[width=450,align="center"]

[[set_payment_method_as_default]]
=== Set a Payment Method as the Default

Kill Bill uses the default payment method to automatically pay invoices (whether that invoice is generated by the system or manually by a user).

To set a payment method as the default:

. Open the account on the Account page.
[.oneline_with_image]#In the Payment Methods section, click the star icon image:../assets/img/kaui/i_StarClear.png[] next to the relevant  payment method:#
+
image::../assets/img/kaui/PaymentMethodStar-Labeled.png[width=450,align="center"]
+

[.oneline_with_image]#The filled star image:../assets/img/kaui/i_StarFilled.png[] indicates it's now the default payment method.#

[[add_payment_method]]
=== Add Payment Method

To add a payment method:

. Open the account on the Account page.
. Next to *Payment Methods*, click the plus sign:
+
image::../assets/img/kaui/PaymentMethods-PlusSign-Labeled.png[width=450,align="center"]
+
Kaui displays the Add New Payment Method screen:
+
image::../assets/img/kaui/AddPaymentMethodScreen.png[width=450,align="center"]
+
. Fill in the fields. For field descriptions, see <<payment_method_field_descriptions, Payment Method Field Descriptions>>.
. Click the *Save* button.

[[payment_method_field_descriptions]]
==== Payment Method Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|External key
|An optional alternate ID for the payment method. Once this is saved for the customer, you cannot change it.

|Plugin name
|Type in the name of the plugin that is associated with this type of payment method.

Each payment method is associated with a payment plugin that does the backend processing related to the payment method. The *Plugin name* field specifies the name of the payment plugin associated with the payment method (_Example:_ `killbill-stripe`).

The Plugin name is typically mentioned in the plugin's `readme` file. For example, in the https://github.com/killbill/killbill-stripe-plugin#using-stripe-checkout[Stripe plugin `readme` file], the plugin name is specified in the command line.

|Card type
|The name of the credit or debit card.

|Card holder name
|The name that appears on the card.

|Expiration month Expiration year
|The month and year the card expires. Enter month as _mm_ and year as _yy_. (_Examples:_ `07` for the month of July and `23` for the year 2023.)

|Credit card number
|The credit card number, typed without dashes.

|Address 1, Address 2, City, ZIP code, State, Country
|The billing address associated with this card.

|Add property (Name/Value)
|Use the *Name/Value* fields to assign custom fields and values to the payment method.

*Note:* Custom fields are an advanced feature. For more information, see <<custom_fields, Custom Fields>>.

|Default payment method?
a|Check the box to set this payment method as the default. Kill Bill uses the default payment method to automatically pay invoices (whether the invoice is generated by the system or manually by a user).

*Note:* If you forget to select this box, you can set the payment method as the default by clicking the star icon next to the payment method on the Account page:

image:PaymentMethodStar-Labeled.png[width=350,align="center"]

|===

[[apply_transaction_to_payment_method]]
=== Apply a Transaction to a Payment Method

This section explains how to apply a transaction to a payment method. These transactions are directly applied on the payment instrument (as opposed to being applied to the unpaid invoice).

Use this functionality only for transactions _unrelated to invoices and/or payments_.

_Example:_
After paying her final invoice, a customer cancels her subscription and demands a full refund because she is dissatisfied. In this case, you would process this transaction (the refund) against the payment method as explained in this section.

You can perform the following transactions from the Payment Methods section:

[cols="1,1"]
[frame=none]
[grid=none]
|===

a| * Authorize
* Capture
* Credit (see note)

a| * Purchase (i.e., charge)
* Refund
* Void

|===

[NOTE]
*Note:* "Credit" here refers to depositing funds directly to the customer card and is unrelated to account credits.

. Open the account on the Account page.
. In the *Payment Methods* area, click the gray down arrow image:../assets/img/kaui/i_GrayDownArrow.png[] next to the payment method.
. Select the type of transaction you want to perform:
+
image::../assets/img/kaui/Payment_Method-Transactions.png[width=450,align="center"]
+
[NOTE]
*Note:* This area lists Authorize, Purchase, and Credit. For other transaction types, click any of these options. You will be able to change the transaction type on the next screen.
+
Kaui displays the Process Transaction screen:
+
image::../assets/img/kaui/ProcessTransaction.png[width=450,align="center"]
+
. Fill in the fields. For field descriptions, see <<process_transaction_field_descriptions, Process Transaction Field Descriptions>>.
. Click the *Save* button. Kaui saves the transaction and displays it on the Payments page.

[[process_transaction_field_descriptions]]
=== Process Transaction Field Descriptions

[cols="1,3"]
|===
^|Field ^|Description

|Transaction type
|From the dropdown list, select the type of transaction you want to perform.

|Amount
|The amount of the transaction.

|Currency
|The currency to use for the transaction. This field defaults from the customer account.

|Payment key
|The unique payment key (ID) to which you want to apply the transaction. This field is required for transaction types that are applied to a specific payment (Capture, Chargeback, Refund, Void).

*Note:* You can copy the payment key for a specific transaction from the *External Key* column of the Payments page. Or you can copy it from the URL displayed on your browser's address line:

 _Example:_

URL: `\https://demo.killbill.io/accounts/cb736a4f-9b56-4074-ae07-1d37b37cb69f/payments/0d1e11e5-2df6-4b6b-992f-e9ff2de38cef`

Payment key: `0d1e11e5-2df6-4b6b-992f-e9ff2de38cef`

|Transaction key
|Kill Bill automatically generates an external transaction key for Authorize, Purchase, and Credit transactions.
To process a transaction that requires the transaction key, open the payment detail from the Payments screen and copy the key from the *Transaction External Key* column.

image:TransactionKey-Labeled.png[width=350,align="center"]

|Reason
|The reason is automatically selected based on https://docs.killbill.io/latest/userguide_configuration.html#_kaui_configuration[Kaui configuration settings]. However, you can make a different selection.

|Comment
|The text you enter here displays on the <<timeline, Timeline>> page after the transaction is complete. Adding comments is optional.

|Add control plugin
|For information on control plugins, see <<plugin_manager, Plugin Manager>>.

|Add property (Name/Value)
|Use this area to assign custom fields and values to the transaction. For information on custom fields, see <<custom_fields, Custom Fields>>.

|===

[[delete_payment_method]]
=== Delete Payment Method

[WARNING]
*Warning:* Kaui does not ask you to confirm your deletion; use this feature with caution.

To delete a payment method:

. Open the account on the Account page.
. In the *Payment Methods* area, click the red X next to the payment method. Kaui _immediately_ removes the payment method.
